<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Aria: lineFinderExample.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Aria
   &#160;<span id="projectnumber">2.9.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('lineFinderExample_8cpp-example.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">lineFinderExample.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>Simple example of <a class="el" href="classAria.html" title="Contains global initialization, deinitialization and other global functions.">Aria</a>'s line-finder utility, which uses data from a laser rangefinder to detect a continues line of points. This example program will constantly search for a line-like pattern in the sensor readings of a laser rangefinder. If you press the 'f' key, those points will be saved in 'points' and 'lines' files. Use arrow keys or joystick to teleoperate the robot.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;Aria.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">  <a name="a0"></a><a class="code" href="classAria.html#ad99c16b5d947229d9f8e1c5b2d4cdd73" title="Initialize Aria global data struture and perform OS-specific initialization, including adding OS sign...">Aria::init</a>();</div>
<div class="line">  <a name="_a1"></a><a class="code" href="classArArgumentParser.html" title="Parse and store program command-line arguments for use by other ARIA classes.">ArArgumentParser</a> parser(&amp;argc, argv);</div>
<div class="line">  parser.<a name="a2"></a><a class="code" href="classArArgumentParser.html#a501694b62a7f8b0c3cadd84aeafe1b35" title="Adds args from default files and environmental variables.">loadDefaultArguments</a>();</div>
<div class="line">  <a name="_a3"></a><a class="code" href="classArRobot.html" title="Central class for communicating with and operating the robot.">ArRobot</a> robot;</div>
<div class="line">  <a name="_a4"></a><a class="code" href="classArRobotConnector.html" title="Connect to robot or simulator based on program command line parameters.">ArRobotConnector</a> robotConnector(&amp;parser, &amp;robot);</div>
<div class="line">  <a name="_a5"></a><a class="code" href="classArLaserConnector.html" title="Create laser interface objects (for any kind of laser supported by ARIA) and connect to lasers based ...">ArLaserConnector</a> laserConnector(&amp;parser, &amp;robot, &amp;robotConnector);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span>(!robotConnector.<a name="a6"></a><a class="code" href="classArRobotConnector.html#ab192ac393d9cc1e5b61b1a82b08d085d" title="Sets up the robot then connects it.">connectRobot</a>())</div>
<div class="line">  {</div>
<div class="line">    <a name="a7"></a><a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a name="a8"></a><a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a012daf6573594f91242f8dd7c02eb74b" title="Use terse logging.">ArLog::Terse</a>, <span class="stringliteral">&quot;lineFinderExample: Could not connect to the robot.&quot;</span>);</div>
<div class="line">    <span class="keywordflow">if</span>(parser.<a name="a9"></a><a class="code" href="classArArgumentParser.html#ac3889cbdfa862031c51bf80e06954914" title="Checks for the help strings and warns about unparsed arguments.">checkHelpAndWarnUnparsed</a>())</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// -help not given</span></div>
<div class="line">        <a name="a10"></a><a class="code" href="classAria.html#a10d71f3d4d0cf7f38c58a1f749f64a42" title="Logs all the options for the program (Calls all the callbacks added with addLogOptionsCB())">Aria::logOptions</a>();</div>
<div class="line">        <a name="a11"></a><a class="code" href="classAria.html#a6abc3d39b3e9548063bb8e78375acc17" title="Shutdown all Aria processes/threads, call exit callbacks, and exit the program.">Aria::exit</a>(1);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (!<a name="a12"></a><a class="code" href="classAria.html#a1b090c01d88bb420b8cf8e0384d25ee1" title="Parses the arguments for the program (calls all the callbacks added with addParseArgsCB())">Aria::parseArgs</a>() || !parser.<a class="code" href="classArArgumentParser.html#ac3889cbdfa862031c51bf80e06954914" title="Checks for the help strings and warns about unparsed arguments.">checkHelpAndWarnUnparsed</a>())</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classAria.html#a10d71f3d4d0cf7f38c58a1f749f64a42" title="Logs all the options for the program (Calls all the callbacks added with addLogOptionsCB())">Aria::logOptions</a>();</div>
<div class="line">    <a class="code" href="classAria.html#a6abc3d39b3e9548063bb8e78375acc17" title="Shutdown all Aria processes/threads, call exit callbacks, and exit the program.">Aria::exit</a>(1);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a name="a13"></a><a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;lineFinderExample: Connected to robot.&quot;</span>);</div>
<div class="line"></div>
<div class="line">  robot.<a name="a14"></a><a class="code" href="classArRobot.html#a3c3d878cfd11a2ef91230005a83bfcaa" title="Starts the instance to do processing in its own new thread.">runAsync</a>(<span class="keyword">true</span>);</div>
<div class="line"></div>
<div class="line">  <span class="comment">// Connect to laser(s) as defined in parameter files.</span></div>
<div class="line">  <span class="comment">// (Some flags are available as arguments to connectLasers() to control error behavior and to control which lasers are put in the list of lasers stored by ArRobot. See docs for details.)</span></div>
<div class="line">  <span class="keywordflow">if</span>(!laserConnector.<a name="a15"></a><a class="code" href="classArLaserConnector.html#ab97ce6a5fedebf44526773bc674b970e" title="Connects all the lasers the robot has that should be auto connected.">connectLasers</a>())</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a012daf6573594f91242f8dd7c02eb74b" title="Use terse logging.">ArLog::Terse</a>, <span class="stringliteral">&quot;Could not connect to configured lasers. Exiting.&quot;</span>);</div>
<div class="line">    <a class="code" href="classAria.html#a6abc3d39b3e9548063bb8e78375acc17" title="Shutdown all Aria processes/threads, call exit callbacks, and exit the program.">Aria::exit</a>(3);</div>
<div class="line">    <span class="keywordflow">return</span> 3;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;lineFinderExample: Connected to laser&quot;</span>);</div>
<div class="line"></div>
<div class="line">  <a name="_a16"></a><a class="code" href="classArKeyHandler.html" title="Perform actions when keyboard keys are pressed.">ArKeyHandler</a> keyHandler;</div>
<div class="line">  <a name="a17"></a><a class="code" href="classAria.html#a9e5496a4ec2c379c8e18706922b57cc1" title="Sets the key handler, so that other classes can find it using getKeyHandler()">Aria::setKeyHandler</a>(&amp;keyHandler);</div>
<div class="line">  robot.<a name="a18"></a><a class="code" href="classArRobot.html#ab4ea516667d2358f35b435d97b616ab1" title="Attachs a key handler.">attachKeyHandler</a>(&amp;keyHandler);</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  <span class="comment">// Create the ArLineFinder object. Set it to log lots of information about its</span></div>
<div class="line">  <span class="comment">// processing.</span></div>
<div class="line"></div>
<div class="line">  <a name="_a19"></a><a class="code" href="classArLaser.html" title="ArRangeDevice interface specialized for laser rangefinder sensors; see ArRangeDevice for more data ac...">ArLaser</a> *laser = robot.<a name="a20"></a><a class="code" href="classArRobot.html#a6078092b71a4e521bbc8f0cb5c92da46" title="Finds a laser in the robot&#39;s list (laserNumber indices start at 1)">findLaser</a>(1);</div>
<div class="line">  <span class="keywordflow">if</span>(!laser)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a012daf6573594f91242f8dd7c02eb74b" title="Use terse logging.">ArLog::Terse</a>, <span class="stringliteral">&quot;lineFinderExample: No laser device connected, exiting.&quot;</span>);</div>
<div class="line">    <a class="code" href="classAria.html#a6abc3d39b3e9548063bb8e78375acc17" title="Shutdown all Aria processes/threads, call exit callbacks, and exit the program.">Aria::exit</a>(4);</div>
<div class="line">    <span class="keywordflow">return</span> 4;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <a name="_a21"></a><a class="code" href="classArLineFinder.html" title="This class finds lines out of any range device with raw readings (lasers for instance)">ArLineFinder</a> lineFinder(laser);</div>
<div class="line">  lineFinder.<a name="a22"></a><a class="code" href="classArLineFinder.html#a58b38357803dc7047cd13b5e11985706" title="Whether to print verbose information about line decisions.">setVerbose</a>(<span class="keyword">true</span>);</div>
<div class="line"></div>
<div class="line">  <span class="comment">// Add key callbacks that simply call the ArLineFinder::getLinesAndSaveThem()</span></div>
<div class="line">  <span class="comment">// function, which searches for lines in the current set of laser sensor</span></div>
<div class="line">  <span class="comment">// readings, and saves them in files with the names &#39;points&#39; and &#39;lines&#39;.</span></div>
<div class="line">  <a name="_a23"></a><a class="code" href="classArFunctorC.html" title="Functor for a member function.">ArFunctorC&lt;ArLineFinder&gt;</a> findLineCB(&amp;lineFinder, </div>
<div class="line">                  &amp;<a name="a24"></a><a class="code" href="classArLineFinder.html#ace8edfb7fe1305cf1f0ae5bd45ba0bfe" title="Gets the lines, then prints them.">ArLineFinder::getLinesAndSaveThem</a>);</div>
<div class="line">  keyHandler.<a name="a25"></a><a class="code" href="classArKeyHandler.html#ad5442ebb21cd242ab168e94686e06759" title="This adds a keyhandler, when the keyToHandle is hit, functor will fire.">addKeyHandler</a>(<span class="charliteral">&#39;f&#39;</span>, &amp;findLineCB);</div>
<div class="line">  keyHandler.<a class="code" href="classArKeyHandler.html#ad5442ebb21cd242ab168e94686e06759" title="This adds a keyhandler, when the keyToHandle is hit, functor will fire.">addKeyHandler</a>(<span class="charliteral">&#39;F&#39;</span>, &amp;findLineCB);</div>
<div class="line"></div>
<div class="line">  </div>
<div class="line">  printf(<span class="stringliteral">&quot;If you press the &#39;f&#39; key the points and lines found will be saved\n&quot;</span>);</div>
<div class="line">  printf(<span class="stringliteral">&quot;Into the &#39;points&#39; and &#39;lines&#39; file in the current working directory\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">  robot.<a name="a26"></a><a class="code" href="group__easy.html#ga95201be7c39b521983b51e6f5d9303e4" title="Suspend calling thread until the ArRobot run loop has exited.">waitForRunExit</a>();</div>
<div class="line">  <a class="code" href="classAria.html#a6abc3d39b3e9548063bb8e78375acc17" title="Shutdown all Aria processes/threads, call exit callbacks, and exit the program.">Aria::exit</a>(0);</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Nov 15 2017 12:04:23 for Aria by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.1 </li>
  </ul>
</div>
</body>
</html>
